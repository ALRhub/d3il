agents:
  _target_: agents.ddpm_agent.DiffusionAgent
  _recursive_: false
  model:
    _target_: agents.models.diffusion.gc_diffusion.Diffusion
    _recursive_: false
    state_dim: ${obs_dim}
    action_dim: ${action_dim}
    beta_schedule: cosine
    n_timesteps: 50
    loss_type: l2
    clip_denoised: true
    predict_epsilon: true
    device: ${device}
    diffusion_x: false
    diffusion_x_M: 10
    model:
      _target_: agents.models.diffusion.diffusion_models.DiffusionMLPNetwork
      action_dim: ${action_dim}
      obs_dim: ${obs_dim}
      t_dim: 16
      residual_style: true
      hidden_dim: ${hidden_dim}
      num_hidden_layers: ${num_hidden_layers}
      dropout: 0
      activation: Mish
      device: ${device}
      goal_conditioned: false
  optimization:
    _target_: torch.optim.Adam
    lr: 0.001
    weight_decay: 0
  trainset: ${trainset}
  valset: ${valset}
  train_batch_size: ${train_batch_size}
  val_batch_size: ${val_batch_size}
  num_workers: ${num_workers}
  epoch: ${epoch}
  device: ${device}
  scale_data: ${scale_data}
  eval_every_n_epochs: ${eval_every_n_epochs}
  discount: 0.99
  use_ema: true
  decay: 0.995
  update_ema_every_n_steps: 1
  goal_window_size: 1
  window_size: ${window_size}
  diffusion_kde: false
  diffusion_kde_samples: 100
  goal_conditioned: false
agent_name: bc
log_dir: logs/avoiding/
data_directory: environments/dataset/data/avoiding/data
wandb:
  entity: davidjia
  project: d3il
group: avoiding_${agent_name}
seed: 42
hidden_dim: 128
num_hidden_layers: 6
n_layer: 4
n_head: 4
n_embd: 72
train_batch_size: 1024
val_batch_size: 1024
num_workers: 4
device: cuda
epoch: 1
eval_every_n_epochs: 1
scale_data: true
obs_dim: 4
action_dim: 2
max_len_data: 200
window_size: 5
trainset:
  _target_: environments.dataset.avoiding_dataset.Avoiding_Dataset
  data_directory: ${data_directory}
  obs_dim: ${obs_dim}
  action_dim: ${action_dim}
  max_len_data: ${max_len_data}
  window_size: ${window_size}
valset:
  _target_: environments.dataset.avoiding_dataset.Avoiding_Dataset
  data_directory: ${data_directory}
  obs_dim: ${obs_dim}
  action_dim: ${action_dim}
  max_len_data: ${max_len_data}
  window_size: ${window_size}
simulation:
  _target_: simulation.avoiding_sim.Avoiding_Sim
  seed: ${seed}
  device: ${device}
  render: true
  n_cores: 1
  n_trajectories: 100
